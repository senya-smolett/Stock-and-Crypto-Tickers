{"ast":null,"code":"var url = require('url');\n\nvar util = require('util');\n\nvar _ = require('lodash');\n\nvar S = require('string');\n\nvar debug = require('debug')('yahoo-finance:utils');\n\nvar request = require('request-promise');\n\nvar moment = require('moment-timezone');\n\nvar tough = require('tough-cookie');\n\nvar Cookie = tough.Cookie;\nvar dateFormats = ['YYYY-MM-DD', 'MM/DD/YYYY'];\nvar cookiejar = new request.jar();\n\nfunction camelize(text) {\n  return S(text).slugify().camelize().s;\n}\n\nfunction augmentHttpRequestOptions(optionalOptions) {\n  if (optionalOptions && optionalOptions.jar) throw new Error(\"node-yahoo-finance does not support 'jar' key in \" + \"optionalHttpRequestOptions, since we need to use our own cookiejar.\");\n  return _.assign({}, optionalOptions, {\n    resolveWithFullResponse: true,\n    jar: cookiejar\n  });\n}\n\nfunction storeCookiesInJar(setCookieHeader, url, cookiejar) {\n  var cookies;\n\n  if (typeof setCookieHeader === 'undefined') {// no-op\n  } else if (setCookieHeader instanceof Array) {\n    cookies = setCookieHeader.map(Cookie.parse);\n  } else if (typeof setCookieHeader === 'string') {\n    cookies = [Cookie.parse(setCookieHeader)];\n  }\n\n  if (cookies) for (var i = 0; i < cookies.length; i++) {\n    // note: async, possible timing issues? TODO\n    cookiejar.setCookie('' + cookies[i], url);\n  }\n}\n\nfunction download(uri, qs, optionalHttpRequestOptions) {\n  var finalHttpRequestOptions = augmentHttpRequestOptions(optionalHttpRequestOptions);\n  debug(url.format({\n    pathname: uri,\n    query: qs\n  }));\n  return request(_.extend({\n    uri: uri,\n    qs: qs\n  }, finalHttpRequestOptions)).then(function (res) {\n    storeCookiesInJar(res.headers['set-cookie'], uri, cookiejar);\n    return optionalHttpRequestOptions && optionalHttpRequestOptions.resolveWithFullResponse ? res : res.body;\n  });\n}\n\nfunction parseCSV(text) {\n  return S(text).trim().s.split('\\n').map(function (line) {\n    return S(line).trim().parseCSV();\n  });\n}\n\nfunction toDate(value, valueForError) {\n  try {\n    var date = moment.tz(value, dateFormats, 'America/New_York').toDate();\n\n    if (date.getFullYear() < 1400) {\n      return null;\n    }\n\n    return date;\n  } catch (err) {\n    if (_.isUndefined(valueForError)) {\n      return null;\n    } else {\n      return valueForError;\n    }\n  }\n}\n\nfunction toFloat(value, valueForNaN) {\n  var result = parseFloat(value);\n\n  if (isNaN(result)) {\n    if (_.isUndefined(valueForNaN)) {\n      return null;\n    } else {\n      return valueForNaN;\n    }\n  } else {\n    return result;\n  }\n}\n\nfunction toInt(value, valueForNaN) {\n  var result = parseInt(value, 10);\n\n  if (isNaN(result)) {\n    if (_.isUndefined(valueForNaN)) {\n      return null;\n    } else {\n      return valueForNaN;\n    }\n  } else {\n    return result;\n  }\n}\n\nexports.cookiejar = cookiejar;\nexports.camelize = camelize;\nexports.download = download;\nexports.parseCSV = parseCSV;\nexports.toDate = toDate;\nexports.toFloat = toFloat;\nexports.toInt = toInt;","map":{"version":3,"sources":["C:/Users/senya/Documents/Coding/React Projects/react-stock-ticker/node_modules/yahoo-finance/lib/utils.js"],"names":["url","require","util","_","S","debug","request","moment","tough","Cookie","dateFormats","cookiejar","jar","camelize","text","slugify","s","augmentHttpRequestOptions","optionalOptions","Error","assign","resolveWithFullResponse","storeCookiesInJar","setCookieHeader","cookies","Array","map","parse","i","length","setCookie","download","uri","qs","optionalHttpRequestOptions","finalHttpRequestOptions","format","pathname","query","extend","then","res","headers","body","parseCSV","trim","split","line","toDate","value","valueForError","date","tz","getFullYear","err","isUndefined","toFloat","valueForNaN","result","parseFloat","isNaN","toInt","parseInt","exports"],"mappings":"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","sourcesContent":["var url = require('url');\nvar util = require('util');\n\nvar _ = require('lodash');\nvar S = require('string');\nvar debug = require('debug')('yahoo-finance:utils');\nvar request = require('request-promise');\nvar moment = require('moment-timezone');\nvar tough = require('tough-cookie');\n\nvar Cookie = tough.Cookie;\nvar dateFormats = ['YYYY-MM-DD', 'MM/DD/YYYY'];\nvar cookiejar = new request.jar();\n\nfunction camelize(text) {\n  return S(text)\n    .slugify()\n    .camelize()\n    .s;\n}\n\nfunction augmentHttpRequestOptions(optionalOptions) {\n  if (optionalOptions && optionalOptions.jar)\n    throw new Error(\"node-yahoo-finance does not support 'jar' key in \" +\n      \"optionalHttpRequestOptions, since we need to use our own cookiejar.\");\n\n  return _.assign({}, optionalOptions, {\n    resolveWithFullResponse: true,\n    jar: cookiejar\n  });\n}\n\nfunction storeCookiesInJar(setCookieHeader, url, cookiejar) {\n  var cookies;\n\n  if (typeof setCookieHeader === 'undefined') {\n    // no-op\n  } else if (setCookieHeader instanceof Array) {\n    cookies = setCookieHeader.map(Cookie.parse);\n  } else if (typeof setCookieHeader === 'string') {\n    cookies = [ Cookie.parse(setCookieHeader) ];\n  }\n\n  if (cookies)\n  for (var i=0; i < cookies.length; i++) {\n    // note: async, possible timing issues? TODO\n    cookiejar.setCookie(''+cookies[i], url);\n  }\n}\n\nfunction download(uri, qs, optionalHttpRequestOptions) {\n  var finalHttpRequestOptions = augmentHttpRequestOptions(optionalHttpRequestOptions);\n\n  debug(url.format({pathname: uri, query: qs}));\n  return request(_.extend({uri: uri, qs: qs}, finalHttpRequestOptions))\n    .then(function(res) {\n      storeCookiesInJar(res.headers['set-cookie'], uri, cookiejar);\n      return (optionalHttpRequestOptions &&\n        optionalHttpRequestOptions.resolveWithFullResponse) ? res : res.body;\n    });\n}\n\nfunction parseCSV(text) {\n  return S(text).trim().s.split('\\n').map(function (line) {\n    return S(line).trim().parseCSV();\n  });\n}\n\nfunction toDate(value, valueForError) {\n  try {\n    var date = moment.tz(value, dateFormats, 'America/New_York').toDate();\n    if (date.getFullYear() < 1400) { return null; }\n    return date;\n  } catch (err) {\n    if (_.isUndefined(valueForError)) {\n      return null;\n    } else {\n      return valueForError;\n    }\n  }\n}\n\nfunction toFloat(value, valueForNaN) {\n  var result = parseFloat(value);\n  if (isNaN(result)) {\n    if (_.isUndefined(valueForNaN)) {\n      return null;\n    } else {\n      return valueForNaN;\n    }\n  } else  {\n    return result;\n  }\n}\n\nfunction toInt(value, valueForNaN) {\n  var result = parseInt(value, 10);\n  if (isNaN(result)) {\n    if (_.isUndefined(valueForNaN)) {\n      return null;\n    } else {\n      return valueForNaN;\n    }\n  } else  {\n    return result;\n  }\n}\n\nexports.cookiejar = cookiejar;\nexports.camelize = camelize;\nexports.download = download;\nexports.parseCSV = parseCSV;\nexports.toDate = toDate;\nexports.toFloat = toFloat;\nexports.toInt = toInt;\n"]},"metadata":{},"sourceType":"script"}