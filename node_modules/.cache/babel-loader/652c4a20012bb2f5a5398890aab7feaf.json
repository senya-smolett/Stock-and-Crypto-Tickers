{"ast":null,"code":"'use strict'; // ---------------------------------------------------------------------------\n\nconst Exchange = require('./base/Exchange');\n\nconst {\n  PAD_WITH_ZERO\n} = require('./base/functions/number');\n\nconst {\n  InvalidOrder,\n  InsufficientFunds,\n  ExchangeError,\n  ExchangeNotAvailable,\n  DDoSProtection,\n  BadRequest,\n  NotSupported,\n  InvalidAddress,\n  AuthenticationError\n} = require('./base/errors'); // ---------------------------------------------------------------------------\n\n\nmodule.exports = class idex extends Exchange {\n  describe() {\n    return this.deepExtend(super.describe(), {\n      'id': 'idex',\n      'name': 'IDEX',\n      'countries': ['US'],\n      'rateLimit': 1500,\n      'version': 'v2',\n      'certified': true,\n      'pro': true,\n      'requiresWeb3': true,\n      'has': {\n        'cancelOrder': true,\n        'createOrder': true,\n        'fetchBalance': true,\n        'fetchMarkets': true,\n        'fetchCurrencies': true,\n        'fetchMyTrades': true,\n        'fetchOHLCV': true,\n        'fetchOpenOrders': true,\n        'fetchClosedOrders': true,\n        'fetchOrders': false,\n        'fetchOrder': true,\n        'fetchOrderBook': true,\n        'fetchTicker': true,\n        'fetchTickers': true,\n        'fetchTrades': true,\n        'fetchTransactions': false,\n        'fetchDeposits': true,\n        'fetchWithdrawals': true,\n        'withdraw': true\n      },\n      'timeframes': {\n        '1m': '1m',\n        '5m': '5m',\n        '15m': '15m',\n        '30m': '30m',\n        '1h': '1h',\n        '6h': '6h',\n        '1d': '1d'\n      },\n      'urls': {\n        'test': {\n          'public': 'https://api-sandbox.idex.io',\n          'private': 'https://api-sandbox.idex.io'\n        },\n        'logo': 'https://user-images.githubusercontent.com/51840849/94481303-2f222100-01e0-11eb-97dd-bc14c5943a86.jpg',\n        'api': {\n          'public': 'https://api.idex.io',\n          'private': 'https://api.idex.io'\n        },\n        'www': 'https://idex.io',\n        'doc': ['https://docs.idex.io/']\n      },\n      'api': {\n        'public': {\n          'get': ['ping', 'time', 'exchange', 'assets', 'markets', 'tickers', 'candles', 'trades', 'orderbook', 'wsToken']\n        },\n        'private': {\n          'get': ['user', 'wallets', 'balances', 'orders', 'fills', 'deposits', 'withdrawals'],\n          'post': ['wallets', 'orders', 'orders/test', 'withdrawals'],\n          'delete': ['orders']\n        }\n      },\n      'options': {\n        'defaultTimeInForce': 'gtc',\n        'defaultSelfTradePrevention': 'cn'\n      },\n      'exceptions': {\n        'INVALID_ORDER_QUANTITY': InvalidOrder,\n        'INSUFFICIENT_FUNDS': InsufficientFunds,\n        'SERVICE_UNAVAILABLE': ExchangeNotAvailable,\n        'EXCEEDED_RATE_LIMIT': DDoSProtection,\n        'INVALID_PARAMETER': BadRequest,\n        'WALLET_NOT_ASSOCIATED': InvalidAddress,\n        'INVALID_WALLET_SIGNATURE': AuthenticationError\n      },\n      'requiredCredentials': {\n        'walletAddress': true,\n        'privateKey': true,\n        'apiKey': true,\n        'secret': true\n      },\n      'paddingMode': PAD_WITH_ZERO,\n      'commonCurrencies': {},\n      'requireCredentials': {\n        'privateKey': true,\n        'apiKey': true,\n        'secret': true\n      }\n    });\n  }\n\n  async fetchMarkets(params = {}) {\n    // [\n    //   {\n    //     market: 'DIL-ETH',\n    //     status: 'active',\n    //     baseAsset: 'DIL',\n    //     baseAssetPrecision: 8,\n    //     quoteAsset: 'ETH',\n    //     quoteAssetPrecision: 8\n    //   }, ...\n    // ]\n    const response = await this.publicGetMarkets(params);\n    const result = [];\n\n    for (let i = 0; i < response.length; i++) {\n      const entry = response[i];\n      const marketId = this.safeString(entry, 'market');\n      const baseId = this.safeString(entry, 'baseAsset');\n      const quoteId = this.safeString(entry, 'quoteAsset');\n      const base = this.safeCurrencyCode(baseId);\n      const quote = this.safeCurrencyCode(quoteId);\n      const symbol = base + '/' + quote;\n      const basePrecision = this.safeInteger(entry, 'baseAssetPrecision');\n      const quotePrecision = this.safeInteger(entry, 'quoteAssetPrecision');\n      const status = this.safeString(entry, 'status');\n      const active = status === 'active';\n      const precision = {\n        'amount': basePrecision,\n        'price': quotePrecision\n      };\n      result.push({\n        'symbol': symbol,\n        'id': marketId,\n        'base': base,\n        'quote': quote,\n        'baseId': baseId,\n        'quoteId': quoteId,\n        'active': active,\n        'info': entry,\n        'precision': precision,\n        'limits': {\n          'amount': {\n            'min': Math.pow(10, -precision['amount']),\n            'max': undefined\n          },\n          'price': {\n            'min': undefined,\n            'max': undefined\n          },\n          'cost': {\n            'min': undefined,\n            'max': undefined\n          }\n        }\n      });\n    }\n\n    return result;\n  }\n\n  async fetchTicker(symbol, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market': market['id']\n    }; // [\n    //   {\n    //     market: 'DIL-ETH',\n    //     time: 1598367493008,\n    //     open: '0.09695361',\n    //     high: '0.10245881',\n    //     low: '0.09572507',\n    //     close: '0.09917079',\n    //     closeQuantity: '0.71320950',\n    //     baseVolume: '309.17380612',\n    //     quoteVolume: '30.57633981',\n    //     percentChange: '2.28',\n    //     numTrades: 205,\n    //     ask: '0.09910476',\n    //     bid: '0.09688340',\n    //     sequence: 3902\n    //   }\n    // ]\n\n    const response = await this.publicGetTickers(this.extend(request, params));\n    const ticker = this.safeValue(response, 0);\n    return this.parseTicker(ticker, market);\n  }\n\n  async fetchTickers(symbols = undefined, params = {}) {\n    await this.loadMarkets(); // [\n    //   {\n    //     market: 'DIL-ETH',\n    //     time: 1598367493008,\n    //     open: '0.09695361',\n    //     high: '0.10245881',\n    //     low: '0.09572507',\n    //     close: '0.09917079',\n    //     closeQuantity: '0.71320950',\n    //     baseVolume: '309.17380612',\n    //     quoteVolume: '30.57633981',\n    //     percentChange: '2.28',\n    //     numTrades: 205,\n    //     ask: '0.09910476',\n    //     bid: '0.09688340',\n    //     sequence: 3902\n    //   }, ...\n    // ]\n\n    const response = await this.publicGetTickers(params);\n    return this.parseTickers(response, symbols);\n  }\n\n  parseTickers(rawTickers, symbols = undefined) {\n    const tickers = [];\n\n    for (let i = 0; i < rawTickers.length; i++) {\n      tickers.push(this.parseTicker(rawTickers[i]));\n    }\n\n    return this.filterByArray(tickers, 'symbol', symbols);\n  }\n\n  parseTicker(ticker, market = undefined) {\n    // {\n    //   market: 'DIL-ETH',\n    //   time: 1598367493008,\n    //   open: '0.09695361',\n    //   high: '0.10245881',\n    //   low: '0.09572507',\n    //   close: '0.09917079',\n    //   closeQuantity: '0.71320950',\n    //   baseVolume: '309.17380612',\n    //   quoteVolume: '30.57633981',\n    //   percentChange: '2.28',\n    //   numTrades: 205,\n    //   ask: '0.09910476',\n    //   bid: '0.09688340',\n    //   sequence: 3902\n    // }\n    const marketId = this.safeString(ticker, 'market');\n    const symbol = this.safeSymbol(marketId, market, '-');\n    const baseVolume = this.safeFloat(ticker, 'baseVolume');\n    const quoteVolume = this.safeFloat(ticker, 'quoteVolume');\n    const timestamp = this.safeInteger(ticker, 'time');\n    const open = this.safeFloat(ticker, 'open');\n    const high = this.safeFloat(ticker, 'high');\n    const low = this.safeFloat(ticker, 'low');\n    const close = this.safeFloat(ticker, 'close');\n    const ask = this.safeFloat(ticker, 'ask');\n    const bid = this.safeFloat(ticker, 'bid');\n    let percentage = this.safeFloat(ticker, 'percentChange');\n\n    if (percentage !== undefined) {\n      percentage = 1 + percentage / 100;\n    }\n\n    let change = undefined;\n\n    if (close !== undefined && open !== undefined) {\n      change = close - open;\n    }\n\n    return {\n      'symbol': symbol,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'high': high,\n      'low': low,\n      'bid': bid,\n      'bidVolume': undefined,\n      'ask': ask,\n      'askVolume': undefined,\n      'vwap': undefined,\n      'open': open,\n      'close': close,\n      'last': close,\n      'previousClose': undefined,\n      'change': change,\n      'percentage': percentage,\n      'average': undefined,\n      'baseVolume': baseVolume,\n      'quoteVolume': quoteVolume,\n      'info': ticker\n    };\n  }\n\n  async fetchOHLCV(symbol, timeframe = '1m', since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market': market['id'],\n      'interval': timeframe\n    };\n\n    if (since !== undefined) {\n      request['start'] = since;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    }\n\n    const response = await this.publicGetCandles(this.extend(request, params));\n\n    if (Array.isArray(response)) {\n      // [\n      //   {\n      //     start: 1598345580000,\n      //     open: '0.09771286',\n      //     high: '0.09771286',\n      //     low: '0.09771286',\n      //     close: '0.09771286',\n      //     volume: '1.45340410',\n      //     sequence: 3853\n      //   }, ...\n      // ]\n      return this.parseOHLCVs(response, market, timeframe, since, limit);\n    } else {\n      //  {\"nextTime\":1595536440000}\n      return [];\n    }\n  }\n\n  parseOHLCV(ohlcv, market = undefined) {\n    // {\n    //   start: 1598345580000,\n    //   open: '0.09771286',\n    //   high: '0.09771286',\n    //   low: '0.09771286',\n    //   close: '0.09771286',\n    //   volume: '1.45340410',\n    //   sequence: 3853\n    // }\n    const timestamp = this.safeInteger(ohlcv, 'start');\n    const open = this.safeFloat(ohlcv, 'open');\n    const high = this.safeFloat(ohlcv, 'high');\n    const low = this.safeFloat(ohlcv, 'low');\n    const close = this.safeFloat(ohlcv, 'close');\n    const volume = this.safeFloat(ohlcv, 'volume');\n    return [timestamp, open, high, low, close, volume];\n  }\n\n  async fetchTrades(symbol, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market': market['id']\n    };\n\n    if (since !== undefined) {\n      request['start'] = since;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    } // [\n    //   {\n    //     fillId: 'b5467d00-b13e-3fa9-8216-dd66735550fc',\n    //     price: '0.09771286',\n    //     quantity: '1.45340410',\n    //     quoteQuantity: '0.14201627',\n    //     time: 1598345638994,\n    //     makerSide: 'buy',\n    //     sequence: 3853\n    //   }, ...\n    // ]\n\n\n    const response = await this.publicGetTrades(this.extend(request, params));\n    return this.parseTrades(response, market, since, limit);\n  }\n\n  parseTrade(trade, market = undefined) {\n    // public trades\n    // {\n    //   fillId: 'b5467d00-b13e-3fa9-8216-dd66735550fc',\n    //   price: '0.09771286',\n    //   quantity: '1.45340410',\n    //   quoteQuantity: '0.14201627',\n    //   time: 1598345638994,\n    //   makerSide: 'buy',\n    //   sequence: 3853\n    // }\n    // private trades\n    // {\n    //   fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n    //   price: '0.09905990',\n    //   quantity: '0.40000000',\n    //   quoteQuantity: '0.03962396',\n    //   time: 1598873478762,\n    //   makerSide: 'sell',\n    //   sequence: 5053,\n    //   market: 'DIL-ETH',\n    //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n    //   side: 'buy',\n    //   fee: '0.00080000',\n    //   feeAsset: 'DIL',\n    //   gas: '0.00857497',\n    //   liquidity: 'taker',\n    //   txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n    //   txStatus: 'mined'\n    // }\n    const id = this.safeString(trade, 'fillId');\n    const price = this.safeFloat(trade, 'price');\n    const amount = this.safeFloat(trade, 'quantity');\n    const cost = this.safeFloat(trade, 'quoteQuantity');\n    const timestamp = this.safeInteger(trade, 'time');\n    const marketId = this.safeString(trade, 'market');\n    const symbol = this.safeSymbol(marketId, market, '-'); // this code handles the duality of public vs private trades\n\n    const makerSide = this.safeString(trade, 'makerSide');\n    const oppositeSide = makerSide === 'buy' ? 'sell' : 'buy';\n    const side = this.safeString(trade, 'side', oppositeSide);\n    const takerOrMaker = this.safeString(trade, 'liquidity', 'taker');\n    const feeCost = this.safeFloat(trade, 'fee');\n    let fee = undefined;\n\n    if (feeCost !== undefined) {\n      const feeCurrencyId = this.safeString(trade, 'feeAsset');\n      fee = {\n        'cost': feeCost,\n        'currency': this.safeCurrencyCode(feeCurrencyId)\n      };\n    }\n\n    const orderId = this.safeString(trade, 'orderId');\n    return {\n      'info': trade,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'symbol': symbol,\n      'id': id,\n      'order': orderId,\n      'type': 'limit',\n      'side': side,\n      'takerOrMaker': takerOrMaker,\n      'price': price,\n      'amount': amount,\n      'cost': cost,\n      'fee': fee\n    };\n  }\n\n  async fetchOrderBook(symbol, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const request = {\n      'market': market['id'],\n      'level': 2\n    };\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    } // {\n    //   sequence: 36416753,\n    //   bids: [\n    //     [ '0.09672815', '8.22284267', 1 ],\n    //     [ '0.09672814', '1.83685554', 1 ],\n    //     [ '0.09672143', '4.10962617', 1 ],\n    //     [ '0.09658884', '4.03863759', 1 ],\n    //     [ '0.09653781', '3.35730684', 1 ],\n    //     [ '0.09624660', '2.54163586', 1 ],\n    //     [ '0.09617490', '1.93065030', 1 ]\n    //   ],\n    //   asks: [\n    //     [ '0.09910476', '3.22840154', 1 ],\n    //     [ '0.09940587', '3.39796593', 1 ],\n    //     [ '0.09948189', '4.25088898', 1 ],\n    //     [ '0.09958362', '2.42195784', 1 ],\n    //     [ '0.09974393', '4.25234367', 1 ],\n    //     [ '0.09995250', '3.40192141', 1 ]\n    //   ]\n    // }\n\n\n    const response = await this.publicGetOrderbook(this.extend(request, params));\n    const nonce = this.safeInteger(response, 'sequence');\n    return {\n      'timestamp': undefined,\n      'datetime': undefined,\n      'nonce': nonce,\n      'bids': this.parseSide(response, 'bids'),\n      'asks': this.parseSide(response, 'asks')\n    };\n  }\n\n  parseSide(book, side) {\n    const bookSide = this.safeValue(book, side, []);\n    const result = [];\n\n    for (let i = 0; i < bookSide.length; i++) {\n      const order = bookSide[i];\n      const price = this.safeFloat(order, 0);\n      const amount = this.safeFloat(order, 1);\n      const orderCount = this.safeInteger(order, 2);\n      result.push([price, amount, orderCount]);\n    }\n\n    const descending = side === 'bids';\n    return this.sortBy(result, 0, descending);\n  }\n\n  async fetchCurrencies(params = {}) {\n    // [\n    //   {\n    //     name: 'Ether',\n    //     symbol: 'ETH',\n    //     contractAddress: '0x0000000000000000000000000000000000000000',\n    //     assetDecimals: 18,\n    //     exchangeDecimals: 8\n    //   }, ..\n    // ]\n    const response = await this.publicGetAssets(params);\n    const result = {};\n\n    for (let i = 0; i < response.length; i++) {\n      const entry = response[i];\n      const name = this.safeString(entry, 'name');\n      const currencyId = this.safeString(entry, 'symbol');\n      const precision = this.safeInteger(entry, 'exchangeDecimals');\n      const code = this.safeCurrencyCode(currencyId);\n      const lot = Math.pow(-10, precision);\n      result[code] = {\n        'id': currencyId,\n        'code': code,\n        'info': entry,\n        'type': undefined,\n        'name': name,\n        'active': undefined,\n        'fee': undefined,\n        'precision': precision,\n        'limits': {\n          'amount': {\n            'min': lot,\n            'max': undefined\n          },\n          'price': {\n            'min': lot,\n            'max': undefined\n          },\n          'cost': {\n            'min': undefined,\n            'max': undefined\n          },\n          'withdraw': {\n            'min': lot,\n            'max': undefined\n          }\n        }\n      };\n    }\n\n    return result;\n  }\n\n  async fetchBalance(params = {}) {\n    this.checkRequiredCredentials();\n    await this.loadMarkets();\n    const nonce1 = this.uuidv1();\n    const request = {\n      'nonce': nonce1,\n      'wallet': this.walletAddress\n    }; // [\n    //   {\n    //     asset: 'DIL',\n    //     quantity: '0.00000000',\n    //     availableForTrade: '0.00000000',\n    //     locked: '0.00000000',\n    //     usdValue: null\n    //   }, ...\n    // ]\n\n    const extendedRequest = this.extend(request, params);\n\n    if (extendedRequest['wallet'] === undefined) {\n      throw new BadRequest(this.id + ' wallet is undefined, set this.walletAddress or \"address\" in params');\n    }\n\n    let response = undefined;\n\n    try {\n      response = await this.privateGetBalances(extendedRequest);\n    } catch (e) {\n      if (e instanceof InvalidAddress) {\n        const walletAddress = extendedRequest['wallet'];\n        await this.associateWallet(walletAddress);\n        response = await this.privateGetBalances(extendedRequest);\n      } else {\n        throw e;\n      }\n    }\n\n    const result = {\n      'info': response\n    };\n\n    for (let i = 0; i < response.length; i++) {\n      const entry = response[i];\n      const currencyId = this.safeString(entry, 'asset');\n      const code = this.safeCurrencyCode(currencyId);\n      const total = this.safeFloat(entry, 'quantity');\n      const free = this.safeFloat(entry, 'availableForTrade');\n      const used = this.safeFloat(entry, 'locked');\n      result[code] = {\n        'free': free,\n        'used': used,\n        'total': total\n      };\n    }\n\n    return this.parseBalance(result);\n  }\n\n  async fetchMyTrades(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    this.checkRequiredCredentials();\n    await this.loadMarkets();\n    let market = undefined;\n    const request = {\n      'nonce': this.uuidv1(),\n      'wallet': this.walletAddress\n    };\n\n    if (symbol !== undefined) {\n      market = this.market(symbol);\n      request['market'] = market['id'];\n    }\n\n    if (since !== undefined) {\n      request['start'] = since;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    } // [\n    //   {\n    //     fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n    //     price: '0.09905990',\n    //     quantity: '0.40000000',\n    //     quoteQuantity: '0.03962396',\n    //     time: 1598873478762,\n    //     makerSide: 'sell',\n    //     sequence: 5053,\n    //     market: 'DIL-ETH',\n    //     orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n    //     side: 'buy',\n    //     fee: '0.00080000',\n    //     feeAsset: 'DIL',\n    //     gas: '0.00857497',\n    //     liquidity: 'taker',\n    //     txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n    //     txStatus: 'mined'\n    //   }\n    // ]\n\n\n    const extendedRequest = this.extend(request, params);\n\n    if (extendedRequest['wallet'] === undefined) {\n      throw new BadRequest(this.id + ' walletAddress is undefined, set this.walletAddress or \"address\" in params');\n    }\n\n    let response = undefined;\n\n    try {\n      response = await this.privateGetFills(extendedRequest);\n    } catch (e) {\n      if (e instanceof InvalidAddress) {\n        const walletAddress = extendedRequest['wallet'];\n        await this.associateWallet(walletAddress);\n        response = await this.privateGetFills(extendedRequest);\n      } else {\n        throw e;\n      }\n    }\n\n    return this.parseTrades(response, market, since, limit);\n  }\n\n  async fetchOrder(id, symbol = undefined, params = {}) {\n    const request = {\n      'orderId': id\n    };\n    return await this.fetchOrdersHelper(symbol, undefined, undefined, this.extend(request, params));\n  }\n\n  async fetchOpenOrders(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    const request = {\n      'closed': false\n    };\n    return await this.fetchOrdersHelper(symbol, since, limit, this.extend(request, params));\n  }\n\n  async fetchClosedOrders(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    const request = {\n      'closed': true\n    };\n    return await this.fetchOrdersHelper(symbol, since, limit, this.extend(request, params));\n  }\n\n  async fetchOrdersHelper(symbol = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const request = {\n      'nonce': this.uuidv1(),\n      'wallet': this.walletAddress\n    };\n    let market = undefined;\n\n    if (symbol !== undefined) {\n      market = this.market(symbol);\n      request['market'] = market['id'];\n    }\n\n    if (since !== undefined) {\n      request['start'] = since;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    }\n\n    const response = await this.privateGetOrders(this.extend(request, params)); // fetchClosedOrders / fetchOpenOrders\n    // [\n    //   {\n    //     \"market\": \"DIL-ETH\",\n    //     \"orderId\": \"7cdc8e90-eb7d-11ea-9e60-4118569f6e63\",\n    //     \"wallet\": \"0x0AB991497116f7F5532a4c2f4f7B1784488628e1\",\n    //     \"time\": 1598873478650,\n    //     \"status\": \"filled\",\n    //     \"type\": \"limit\",\n    //     \"side\": \"buy\",\n    //     \"originalQuantity\": \"0.40000000\",\n    //     \"executedQuantity\": \"0.40000000\",\n    //     \"cumulativeQuoteQuantity\": \"0.03962396\",\n    //     \"avgExecutionPrice\": \"0.09905990\",\n    //     \"price\": \"1.00000000\",\n    //     \"fills\": [\n    //       {\n    //         \"fillId\": \"48582d10-b9bb-3c4b-94d3-e67537cf2472\",\n    //         \"price\": \"0.09905990\",\n    //         \"quantity\": \"0.40000000\",\n    //         \"quoteQuantity\": \"0.03962396\",\n    //         \"time\": 1598873478650,\n    //         \"makerSide\": \"sell\",\n    //         \"sequence\": 5053,\n    //         \"fee\": \"0.00080000\",\n    //         \"feeAsset\": \"DIL\",\n    //         \"gas\": \"0.00857497\",\n    //         \"liquidity\": \"taker\",\n    //         \"txId\": \"0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65\",\n    //         \"txStatus\": \"mined\"\n    //       }\n    //     ]\n    //   }\n    // ]\n    // fetchOrder\n    // { market: 'DIL-ETH',\n    //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n    //   wallet: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n    //   time: 1598873478650,\n    //   status: 'filled',\n    //   type: 'limit',\n    //   side: 'buy',\n    //   originalQuantity: '0.40000000',\n    //   executedQuantity: '0.40000000',\n    //   cumulativeQuoteQuantity: '0.03962396',\n    //   avgExecutionPrice: '0.09905990',\n    //   price: '1.00000000',\n    //   fills:\n    //    [ { fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n    //        price: '0.09905990',\n    //        quantity: '0.40000000',\n    //        quoteQuantity: '0.03962396',\n    //        time: 1598873478650,\n    //        makerSide: 'sell',\n    //        sequence: 5053,\n    //        fee: '0.00080000',\n    //        feeAsset: 'DIL',\n    //        gas: '0.00857497',\n    //        liquidity: 'taker',\n    //        txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n    //        txStatus: 'mined' } ] }\n\n    if (Array.isArray(response)) {\n      return this.parseOrders(response, market, since, limit);\n    } else {\n      return this.parseOrder(response, market);\n    }\n  }\n\n  parseOrderStatus(status) {\n    // https://docs.idex.io/#order-states-amp-lifecycle\n    const statuses = {\n      'active': 'open',\n      'partiallyFilled': 'open',\n      'rejected': 'canceled',\n      'filled': 'closed'\n    };\n    return this.safeString(statuses, status, status);\n  }\n\n  parseOrder(order, market = undefined) {\n    //\n    //     {\n    //         \"market\": \"DIL-ETH\",\n    //         \"orderId\": \"7cdc8e90-eb7d-11ea-9e60-4118569f6e63\",\n    //         \"wallet\": \"0x0AB991497116f7F5532a4c2f4f7B1784488628e1\",\n    //         \"time\": 1598873478650,\n    //         \"status\": \"filled\",\n    //         \"type\": \"limit\",\n    //         \"side\": \"buy\",\n    //         \"originalQuantity\": \"0.40000000\",\n    //         \"executedQuantity\": \"0.40000000\",\n    //         \"cumulativeQuoteQuantity\": \"0.03962396\",\n    //         \"avgExecutionPrice\": \"0.09905990\",\n    //         \"price\": \"1.00000000\",\n    //         \"fills\": [\n    //             {\n    //             \"fillId\": \"48582d10-b9bb-3c4b-94d3-e67537cf2472\",\n    //             \"price\": \"0.09905990\",\n    //             \"quantity\": \"0.40000000\",\n    //             \"quoteQuantity\": \"0.03962396\",\n    //             \"time\": 1598873478650,\n    //             \"makerSide\": \"sell\",\n    //             \"sequence\": 5053,\n    //             \"fee\": \"0.00080000\",\n    //             \"feeAsset\": \"DIL\",\n    //             \"gas\": \"0.00857497\",\n    //             \"liquidity\": \"taker\",\n    //             \"txId\": \"0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65\",\n    //             \"txStatus\": \"mined\"\n    //             }\n    //         ]\n    //     }\n    //\n    const timestamp = this.safeInteger(order, 'time');\n    const fills = this.safeValue(order, 'fills', []);\n    const id = this.safeString(order, 'orderId');\n    const clientOrderId = this.safeString(order, 'clientOrderId');\n    const marketId = this.safeString(order, 'market');\n    const side = this.safeString(order, 'side');\n    const symbol = this.safeSymbol(marketId, market, '-');\n    const trades = this.parseTrades(fills, market);\n    const type = this.safeString(order, 'type');\n    const amount = this.safeFloat(order, 'originalQuantity');\n    const filled = this.safeFloat(order, 'executedQuantity');\n    let remaining = undefined;\n\n    if (amount !== undefined && filled !== undefined) {\n      remaining = amount - filled;\n    }\n\n    const average = this.safeFloat(order, 'avgExecutionPrice');\n    const price = this.safeFloat(order, 'price', average); // for market orders\n\n    let cost = undefined;\n\n    if (amount !== undefined && price !== undefined) {\n      cost = amount * price;\n    }\n\n    const rawStatus = this.safeString(order, 'status');\n    const status = this.parseOrderStatus(rawStatus);\n    const fee = {\n      'currency': undefined,\n      'cost': undefined\n    };\n    let lastTrade = undefined;\n\n    for (let i = 0; i < trades.length; i++) {\n      lastTrade = trades[i];\n      fee['currency'] = lastTrade['fee']['currency'];\n      fee['cost'] = this.sum(fee['cost'], lastTrade['fee']['cost']);\n    }\n\n    const lastTradeTimestamp = this.safeInteger(lastTrade, 'timestamp');\n    return {\n      'info': order,\n      'id': id,\n      'clientOrderId': clientOrderId,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'lastTradeTimestamp': lastTradeTimestamp,\n      'symbol': symbol,\n      'type': type,\n      'timeInForce': undefined,\n      'postOnly': undefined,\n      'side': side,\n      'price': price,\n      'stopPrice': undefined,\n      'amount': amount,\n      'cost': cost,\n      'average': average,\n      'filled': filled,\n      'remaining': remaining,\n      'status': status,\n      'fee': fee,\n      'trades': trades\n    };\n  }\n\n  async associateWallet(walletAddress, params = {}) {\n    const nonce = this.uuidv1();\n    const noPrefix = this.remove0xPrefix(walletAddress);\n    const byteArray = [this.base16ToBinary(nonce), this.base16ToBinary(noPrefix)];\n    const binary = this.binaryConcatArray(byteArray);\n    const hash = this.hash(binary, 'keccak', 'hex');\n    const signature = this.signMessageString(hash, this.privateKey); // {\n    //   address: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n    //   totalPortfolioValueUsd: '0.00',\n    //   time: 1598468353626\n    // }\n\n    const request = {\n      'parameters': {\n        'nonce': nonce,\n        'wallet': walletAddress\n      },\n      'signature': signature\n    };\n    const result = await this.privatePostWallets(request);\n    return result;\n  }\n\n  async createOrder(symbol, type, side, amount, price = undefined, params = {}) {\n    // https://docs.idex.io/#create-order\n    this.checkRequiredCredentials();\n    await this.loadMarkets();\n    const market = this.market(symbol);\n    const nonce = this.uuidv1();\n    let typeEnum = undefined;\n    const stopLossTypeEnums = {\n      'stopLoss': 3,\n      'stopLossLimit': 4,\n      'takeProfit': 5,\n      'takeProfitLimit': 6\n    };\n    let stopPriceString = undefined;\n\n    if (type === 'stopLossLimit' || type === 'takeProfitLimit' || 'stopPrice' in params) {\n      if (!('stopPrice' in params)) {\n        throw new BadRequest(this.id + ' stopPrice is a required parameter for ' + type + 'orders');\n      }\n\n      stopPriceString = this.priceToPrecision(symbol, params['stopPrice']);\n    }\n\n    const limitTypeEnums = {\n      'limit': 1,\n      'limitMaker': 2\n    };\n    let priceString = undefined;\n    const typeLower = type.toLowerCase();\n    const limitOrder = typeLower.indexOf('limit') > -1;\n\n    if (type in limitTypeEnums) {\n      typeEnum = limitTypeEnums[type];\n      priceString = this.priceToPrecision(symbol, price);\n    } else if (type in stopLossTypeEnums) {\n      typeEnum = stopLossTypeEnums[type];\n      priceString = this.priceToPrecision(symbol, price);\n    } else if (type === 'market') {\n      typeEnum = 0;\n    } else {\n      throw new BadRequest(this.id + ' ' + type + ' is not a valid order type');\n    }\n\n    let amountEnum = 0; // base quantity\n\n    if ('quoteOrderQuantity' in params) {\n      if (type !== 'market') {\n        throw new NotSupported(this.id + ' quoteOrderQuantity is not supported for ' + type + ' orders, only supported for market orders');\n      }\n\n      amountEnum = 1;\n      amount = this.safeFloat(params, 'quoteOrderQuantity');\n    }\n\n    const sideEnum = side === 'buy' ? 0 : 1;\n    const walletBytes = this.remove0xPrefix(this.walletAddress);\n    const orderVersion = 1;\n    const amountString = this.amountToPrecision(symbol, amount); // https://docs.idex.io/#time-in-force\n\n    const timeInForceEnums = {\n      'gtc': 0,\n      'ioc': 2,\n      'fok': 3\n    };\n    const defaultTimeInForce = this.safeString(this.options, 'defaultTimeInForce', 'gtc');\n    const timeInForce = this.safeString(params, 'timeInForce', defaultTimeInForce);\n    let timeInForceEnum = undefined;\n\n    if (timeInForce in timeInForceEnums) {\n      timeInForceEnum = timeInForceEnums[timeInForce];\n    } else {\n      const allOptions = Object.keys(timeInForceEnums);\n      const asString = allOptions.join(', ');\n      throw new BadRequest(this.id + ' ' + timeInForce + ' is not a valid timeInForce, please choose one of ' + asString);\n    } // https://docs.idex.io/#self-trade-prevention\n\n\n    const selfTradePreventionEnums = {\n      'dc': 0,\n      'co': 1,\n      'cn': 2,\n      'cb': 3\n    };\n    const defaultSelfTradePrevention = this.safeString(this.options, 'defaultSelfTradePrevention', 'cn');\n    const selfTradePrevention = this.safeString(params, 'selfTradePrevention', defaultSelfTradePrevention);\n    let selfTradePreventionEnum = undefined;\n\n    if (selfTradePrevention in selfTradePreventionEnums) {\n      selfTradePreventionEnum = selfTradePreventionEnums[selfTradePrevention];\n    } else {\n      const allOptions = Object.keys(selfTradePreventionEnums);\n      const asString = allOptions.join(', ');\n      throw new BadRequest(this.id + ' ' + selfTradePrevention + ' is not a valid selfTradePrevention, please choose one of ' + asString);\n    }\n\n    const byteArray = [this.numberToBE(orderVersion, 1), this.base16ToBinary(nonce), this.base16ToBinary(walletBytes), this.stringToBinary(this.encode(market['id'])), // TODO: refactor to remove either encode or stringToBinary\n    this.numberToBE(typeEnum, 1), this.numberToBE(sideEnum, 1), this.stringToBinary(this.encode(amountString)), this.numberToBE(amountEnum, 1)];\n\n    if (limitOrder) {\n      const encodedPrice = this.stringToBinary(this.encode(priceString));\n      byteArray.push(encodedPrice);\n    }\n\n    if (type in stopLossTypeEnums) {\n      const encodedPrice = this.stringToBinary(this.encode(stopPriceString || priceString));\n      byteArray.push(encodedPrice);\n    }\n\n    const clientOrderId = this.safeString(params, 'clientOrderId');\n\n    if (clientOrderId !== undefined) {\n      byteArray.push(this.stringToBinary(this.encode(clientOrderId)));\n    }\n\n    const after = [this.numberToBE(timeInForceEnum, 1), this.numberToBE(selfTradePreventionEnum, 1), this.numberToBE(0, 8) // unused\n    ];\n    const allBytes = this.arrayConcat(byteArray, after);\n    const binary = this.binaryConcatArray(allBytes);\n    const hash = this.hash(binary, 'keccak', 'hex');\n    const signature = this.signMessageString(hash, this.privateKey);\n    const request = {\n      'parameters': {\n        'nonce': nonce,\n        'market': market['id'],\n        'side': side,\n        'type': type,\n        'wallet': this.walletAddress,\n        'timeInForce': timeInForce,\n        'selfTradePrevention': selfTradePrevention\n      },\n      'signature': signature\n    };\n\n    if (limitOrder) {\n      request['parameters']['price'] = priceString;\n    }\n\n    if (type in stopLossTypeEnums) {\n      request['parameters']['stopPrice'] = stopPriceString || priceString;\n    }\n\n    if (amountEnum === 0) {\n      request['parameters']['quantity'] = amountString;\n    } else {\n      request['parameters']['quoteOrderQuantity'] = amountString;\n    }\n\n    if (clientOrderId !== undefined) {\n      request['parameters']['clientOrderId'] = clientOrderId;\n    } // {\n    //   market: 'DIL-ETH',\n    //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n    //   wallet: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n    //   time: 1598873478650,\n    //   status: 'filled',\n    //   type: 'limit',\n    //   side: 'buy',\n    //   originalQuantity: '0.40000000',\n    //   executedQuantity: '0.40000000',\n    //   cumulativeQuoteQuantity: '0.03962396',\n    //   price: '1.00000000',\n    //   fills: [\n    //     {\n    //       fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n    //       price: '0.09905990',\n    //       quantity: '0.40000000',\n    //       quoteQuantity: '0.03962396',\n    //       time: 1598873478650,\n    //       makerSide: 'sell',\n    //       sequence: 5053,\n    //       fee: '0.00080000',\n    //       feeAsset: 'DIL',\n    //       gas: '0.00857497',\n    //       liquidity: 'taker',\n    //       txStatus: 'pending'\n    //     }\n    //   ],\n    //   avgExecutionPrice: '0.09905990'\n    // }\n    // we don't use extend here because it is a signed endpoint\n\n\n    const response = await this.privatePostOrders(request);\n    return this.parseOrder(response, market);\n  }\n\n  async withdraw(code, amount, address, tag = undefined, params = {}) {\n    this.checkRequiredCredentials();\n    await this.loadMarkets();\n    const nonce = this.uuidv1();\n    const amountString = this.currencyToPrecision(code, amount);\n    const currency = this.currency(code);\n    const walletBytes = this.remove0xPrefix(this.walletAddress);\n    const byteArray = [this.base16ToBinary(nonce), this.base16ToBinary(walletBytes), this.stringToBinary(this.encode(currency['id'])), this.stringToBinary(this.encode(amountString)), this.numberToBE(1, 1) // bool set to true\n    ];\n    const binary = this.binaryConcatArray(byteArray);\n    const hash = this.hash(binary, 'keccak', 'hex');\n    const signature = this.signMessageString(hash, this.privateKey);\n    const request = {\n      'parameters': {\n        'nonce': nonce,\n        'wallet': address,\n        'asset': currency['id'],\n        'quantity': amountString\n      },\n      'signature': signature\n    }; // {\n    //   withdrawalId: 'a61dcff0-ec4d-11ea-8b83-c78a6ecb3180',\n    //   asset: 'ETH',\n    //   assetContractAddress: '0x0000000000000000000000000000000000000000',\n    //   quantity: '0.20000000',\n    //   time: 1598962883190,\n    //   fee: '0.00024000',\n    //   txStatus: 'pending',\n    //   txId: null\n    // }\n\n    const response = await this.privatePostWithdrawals(request);\n    const id = this.safeString(response, 'withdrawalId');\n    return {\n      'info': response,\n      'id': id\n    };\n  }\n\n  async cancelOrder(id, symbol = undefined, params = {}) {\n    this.checkRequiredCredentials();\n    await this.loadMarkets();\n    let market = undefined;\n\n    if (symbol !== undefined) {\n      market = this.market(symbol);\n    }\n\n    const nonce = this.uuidv1();\n    const walletBytes = this.remove0xPrefix(this.walletAddress);\n    const byteArray = [this.base16ToBinary(nonce), this.base16ToBinary(walletBytes), this.stringToBinary(this.encode(id))];\n    const binary = this.binaryConcatArray(byteArray);\n    const hash = this.hash(binary, 'keccak', 'hex');\n    const signature = this.signMessageString(hash, this.privateKey);\n    const request = {\n      'parameters': {\n        'nonce': nonce,\n        'wallet': this.walletAddress,\n        'orderId': id\n      },\n      'signature': signature\n    }; // [ { orderId: '688336f0-ec50-11ea-9842-b332f8a34d0e' } ]\n\n    const response = await this.privateDeleteOrders(this.extend(request, params));\n    const canceledOrder = this.safeValue(response, 0);\n    return this.parseOrder(canceledOrder, market);\n  }\n\n  handleErrors(code, reason, url, method, headers, body, response, requestHeaders, requestBody) {\n    const errorCode = this.safeString(response, 'code');\n    const message = this.safeString(response, 'message');\n\n    if (errorCode in this.exceptions) {\n      const Exception = this.exceptions[errorCode];\n      throw new Exception(this.id + ' ' + message);\n    }\n\n    if (errorCode !== undefined) {\n      throw new ExchangeError(this.id + ' ' + message);\n    }\n  }\n\n  async fetchDeposits(code = undefined, since = undefined, limit = undefined, params = {}) {\n    params = this.extend({\n      'method': 'privateGetDeposits'\n    }, params);\n    return this.fetchTransactionsHelper(code, since, limit, params);\n  }\n\n  async fetchWithdrawals(code = undefined, since = undefined, limit = undefined, params = {}) {\n    params = this.extend({\n      'method': 'privateGetWithdrawals'\n    }, params);\n    return this.fetchTransactionsHelper(code, since, limit, params);\n  }\n\n  async fetchTransactionsHelper(code = undefined, since = undefined, limit = undefined, params = {}) {\n    await this.loadMarkets();\n    const nonce = this.uuidv1();\n    const request = {\n      'nonce': nonce,\n      'wallet': this.walletAddress\n    };\n    let currency = undefined;\n\n    if (code !== undefined) {\n      currency = this.currency(code);\n      request['asset'] = currency['id'];\n    }\n\n    if (since !== undefined) {\n      request['start'] = since;\n    }\n\n    if (limit !== undefined) {\n      request['limit'] = limit;\n    } // [\n    //   {\n    //     depositId: 'e9970cc0-eb6b-11ea-9e89-09a5ebc1f98e',\n    //     asset: 'ETH',\n    //     quantity: '1.00000000',\n    //     txId: '0xcd4aac3171d7131cc9e795568c67938675185ac17641553ef54c8a7c294c8142',\n    //     txTime: 1598865853000,\n    //     confirmationTime: 1598865930231\n    //   }\n    // ]\n\n\n    const method = params['method'];\n    params = this.omit(params, 'method');\n    const response = await this[method](this.extend(request, params));\n    return this.parseTransactions(response, currency, since, limit);\n  }\n\n  parseTransactionStatus(status) {\n    const statuses = {\n      'mined': 'ok'\n    };\n    return this.safeString(statuses, status, status);\n  }\n\n  parseTransaction(transaction, currency = undefined) {\n    // fetchDeposits\n    // {\n    //   depositId: 'e9970cc0-eb6b-11ea-9e89-09a5ebc1f98f',\n    //   asset: 'ETH',\n    //   quantity: '1.00000000',\n    //   txId: '0xcd4aac3171d7131cc9e795568c67938675185ac17641553ef54c8a7c294c8142',\n    //   txTime: 1598865853000,\n    //   confirmationTime: 1598865930231\n    // }\n    // fetchWithdrwalas\n    // {\n    //   withdrawalId: 'a62d8760-ec4d-11ea-9fa6-47904c19499b',\n    //   asset: 'ETH',\n    //   assetContractAddress: '0x0000000000000000000000000000000000000000',\n    //   quantity: '0.20000000',\n    //   time: 1598962883288,\n    //   fee: '0.00024000',\n    //   txId: '0x305e9cdbaa85ad029f50578d13d31d777c085de573ed5334d95c19116d8c03ce',\n    //   txStatus: 'mined'\n    //  }\n    let type = undefined;\n\n    if ('depositId' in transaction) {\n      type = 'deposit';\n    } else if ('withdrawalId' in transaction) {\n      type = 'withdrawal';\n    }\n\n    const id = this.safeString2(transaction, 'depositId', 'withdrawId');\n    const code = this.safeCurrencyCode(this.safeString(transaction, 'asset'), currency);\n    const amount = this.safeFloat(transaction, 'quantity');\n    const txid = this.safeString(transaction, 'txId');\n    const timestamp = this.safeInteger(transaction, 'txTime');\n    let fee = undefined;\n\n    if ('fee' in transaction) {\n      fee = {\n        'cost': this.safeFloat(transaction, 'fee'),\n        'currency': 'ETH'\n      };\n    }\n\n    const rawStatus = this.safeString(transaction, 'txStatus');\n    const status = this.parseTransactionStatus(rawStatus);\n    const updated = this.safeInteger(transaction, 'confirmationTime');\n    return {\n      'info': transaction,\n      'id': id,\n      'txid': txid,\n      'timestamp': timestamp,\n      'datetime': this.iso8601(timestamp),\n      'address': undefined,\n      'tag': undefined,\n      'type': type,\n      'amount': amount,\n      'currency': code,\n      'status': status,\n      'updated': updated,\n      'fee': fee\n    };\n  }\n\n  sign(path, api = 'public', method = 'GET', params = {}, headers = undefined, body = undefined) {\n    const version = this.safeString(this.options, 'version', 'v1');\n    let url = this.urls['api'][api] + '/' + version + '/' + path;\n    const keys = Object.keys(params);\n    const length = keys.length;\n    let query = undefined;\n\n    if (length > 0) {\n      if (method === 'GET') {\n        query = this.urlencode(params);\n        url = url + '?' + query;\n      } else {\n        body = this.json(params);\n      }\n    }\n\n    headers = {\n      'Content-Type': 'application/json'\n    };\n\n    if (this.apiKey !== undefined) {\n      headers['IDEX-API-Key'] = this.apiKey;\n    }\n\n    if (api === 'private') {\n      let payload = undefined;\n\n      if (method === 'GET') {\n        payload = query;\n      } else {\n        payload = body;\n      }\n\n      headers['IDEX-HMAC-Signature'] = this.hmac(this.encode(payload), this.encode(this.secret), 'sha256', 'hex');\n    }\n\n    return {\n      'url': url,\n      'method': method,\n      'body': body,\n      'headers': headers\n    };\n  }\n\n};","map":{"version":3,"sources":["C:/Users/senya/Documents/Coding/React Projects/react-stock-ticker/node_modules/ccxt/js/idex.js"],"names":["Exchange","require","PAD_WITH_ZERO","InvalidOrder","InsufficientFunds","ExchangeError","ExchangeNotAvailable","DDoSProtection","BadRequest","NotSupported","InvalidAddress","AuthenticationError","module","exports","idex","describe","deepExtend","fetchMarkets","params","response","publicGetMarkets","result","i","length","entry","marketId","safeString","baseId","quoteId","base","safeCurrencyCode","quote","symbol","basePrecision","safeInteger","quotePrecision","status","active","precision","push","Math","pow","undefined","fetchTicker","loadMarkets","market","request","publicGetTickers","extend","ticker","safeValue","parseTicker","fetchTickers","symbols","parseTickers","rawTickers","tickers","filterByArray","safeSymbol","baseVolume","safeFloat","quoteVolume","timestamp","open","high","low","close","ask","bid","percentage","change","iso8601","fetchOHLCV","timeframe","since","limit","publicGetCandles","Array","isArray","parseOHLCVs","parseOHLCV","ohlcv","volume","fetchTrades","publicGetTrades","parseTrades","parseTrade","trade","id","price","amount","cost","makerSide","oppositeSide","side","takerOrMaker","feeCost","fee","feeCurrencyId","orderId","fetchOrderBook","publicGetOrderbook","nonce","parseSide","book","bookSide","order","orderCount","descending","sortBy","fetchCurrencies","publicGetAssets","name","currencyId","code","lot","fetchBalance","checkRequiredCredentials","nonce1","uuidv1","walletAddress","extendedRequest","privateGetBalances","e","associateWallet","total","free","used","parseBalance","fetchMyTrades","privateGetFills","fetchOrder","fetchOrdersHelper","fetchOpenOrders","fetchClosedOrders","privateGetOrders","parseOrders","parseOrder","parseOrderStatus","statuses","fills","clientOrderId","trades","type","filled","remaining","average","rawStatus","lastTrade","sum","lastTradeTimestamp","noPrefix","remove0xPrefix","byteArray","base16ToBinary","binary","binaryConcatArray","hash","signature","signMessageString","privateKey","privatePostWallets","createOrder","typeEnum","stopLossTypeEnums","stopPriceString","priceToPrecision","limitTypeEnums","priceString","typeLower","toLowerCase","limitOrder","indexOf","amountEnum","sideEnum","walletBytes","orderVersion","amountString","amountToPrecision","timeInForceEnums","defaultTimeInForce","options","timeInForce","timeInForceEnum","allOptions","Object","keys","asString","join","selfTradePreventionEnums","defaultSelfTradePrevention","selfTradePrevention","selfTradePreventionEnum","numberToBE","stringToBinary","encode","encodedPrice","after","allBytes","arrayConcat","privatePostOrders","withdraw","address","tag","currencyToPrecision","currency","privatePostWithdrawals","cancelOrder","privateDeleteOrders","canceledOrder","handleErrors","reason","url","method","headers","body","requestHeaders","requestBody","errorCode","message","exceptions","Exception","fetchDeposits","fetchTransactionsHelper","fetchWithdrawals","omit","parseTransactions","parseTransactionStatus","parseTransaction","transaction","safeString2","txid","updated","sign","path","api","version","urls","query","urlencode","json","apiKey","payload","hmac","secret"],"mappings":"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","sourcesContent":["'use strict';\n\n// ---------------------------------------------------------------------------\n\nconst Exchange = require ('./base/Exchange');\nconst { PAD_WITH_ZERO } = require ('./base/functions/number');\nconst { InvalidOrder, InsufficientFunds, ExchangeError, ExchangeNotAvailable, DDoSProtection, BadRequest, NotSupported, InvalidAddress, AuthenticationError } = require ('./base/errors');\n\n// ---------------------------------------------------------------------------\n\nmodule.exports = class idex extends Exchange {\n    describe () {\n        return this.deepExtend (super.describe (), {\n            'id': 'idex',\n            'name': 'IDEX',\n            'countries': [ 'US' ],\n            'rateLimit': 1500,\n            'version': 'v2',\n            'certified': true,\n            'pro': true,\n            'requiresWeb3': true,\n            'has': {\n                'cancelOrder': true,\n                'createOrder': true,\n                'fetchBalance': true,\n                'fetchMarkets': true,\n                'fetchCurrencies': true,\n                'fetchMyTrades': true,\n                'fetchOHLCV': true,\n                'fetchOpenOrders': true,\n                'fetchClosedOrders': true,\n                'fetchOrders': false,\n                'fetchOrder': true,\n                'fetchOrderBook': true,\n                'fetchTicker': true,\n                'fetchTickers': true,\n                'fetchTrades': true,\n                'fetchTransactions': false,\n                'fetchDeposits': true,\n                'fetchWithdrawals': true,\n                'withdraw': true,\n            },\n            'timeframes': {\n                '1m': '1m',\n                '5m': '5m',\n                '15m': '15m',\n                '30m': '30m',\n                '1h': '1h',\n                '6h': '6h',\n                '1d': '1d',\n            },\n            'urls': {\n                'test': {\n                    'public': 'https://api-sandbox.idex.io',\n                    'private': 'https://api-sandbox.idex.io',\n                },\n                'logo': 'https://user-images.githubusercontent.com/51840849/94481303-2f222100-01e0-11eb-97dd-bc14c5943a86.jpg',\n                'api': {\n                    'public': 'https://api.idex.io',\n                    'private': 'https://api.idex.io',\n                },\n                'www': 'https://idex.io',\n                'doc': [\n                    'https://docs.idex.io/',\n                ],\n            },\n            'api': {\n                'public': {\n                    'get': [\n                        'ping',\n                        'time',\n                        'exchange',\n                        'assets',\n                        'markets',\n                        'tickers',\n                        'candles',\n                        'trades',\n                        'orderbook',\n                        'wsToken',\n                    ],\n                },\n                'private': {\n                    'get': [\n                        'user',\n                        'wallets',\n                        'balances',\n                        'orders',\n                        'fills',\n                        'deposits',\n                        'withdrawals',\n                    ],\n                    'post': [\n                        'wallets',\n                        'orders',\n                        'orders/test',\n                        'withdrawals',\n                    ],\n                    'delete': [\n                        'orders',\n                    ],\n                },\n            },\n            'options': {\n                'defaultTimeInForce': 'gtc',\n                'defaultSelfTradePrevention': 'cn',\n            },\n            'exceptions': {\n                'INVALID_ORDER_QUANTITY': InvalidOrder,\n                'INSUFFICIENT_FUNDS': InsufficientFunds,\n                'SERVICE_UNAVAILABLE': ExchangeNotAvailable,\n                'EXCEEDED_RATE_LIMIT': DDoSProtection,\n                'INVALID_PARAMETER': BadRequest,\n                'WALLET_NOT_ASSOCIATED': InvalidAddress,\n                'INVALID_WALLET_SIGNATURE': AuthenticationError,\n            },\n            'requiredCredentials': {\n                'walletAddress': true,\n                'privateKey': true,\n                'apiKey': true,\n                'secret': true,\n            },\n            'paddingMode': PAD_WITH_ZERO,\n            'commonCurrencies': {},\n            'requireCredentials': {\n                'privateKey': true,\n                'apiKey': true,\n                'secret': true,\n            },\n        });\n    }\n\n    async fetchMarkets (params = {}) {\n        // [\n        //   {\n        //     market: 'DIL-ETH',\n        //     status: 'active',\n        //     baseAsset: 'DIL',\n        //     baseAssetPrecision: 8,\n        //     quoteAsset: 'ETH',\n        //     quoteAssetPrecision: 8\n        //   }, ...\n        // ]\n        const response = await this.publicGetMarkets (params);\n        const result = [];\n        for (let i = 0; i < response.length; i++) {\n            const entry = response[i];\n            const marketId = this.safeString (entry, 'market');\n            const baseId = this.safeString (entry, 'baseAsset');\n            const quoteId = this.safeString (entry, 'quoteAsset');\n            const base = this.safeCurrencyCode (baseId);\n            const quote = this.safeCurrencyCode (quoteId);\n            const symbol = base + '/' + quote;\n            const basePrecision = this.safeInteger (entry, 'baseAssetPrecision');\n            const quotePrecision = this.safeInteger (entry, 'quoteAssetPrecision');\n            const status = this.safeString (entry, 'status');\n            const active = status === 'active';\n            const precision = {\n                'amount': basePrecision,\n                'price': quotePrecision,\n            };\n            result.push ({\n                'symbol': symbol,\n                'id': marketId,\n                'base': base,\n                'quote': quote,\n                'baseId': baseId,\n                'quoteId': quoteId,\n                'active': active,\n                'info': entry,\n                'precision': precision,\n                'limits': {\n                    'amount': {\n                        'min': Math.pow (10, -precision['amount']),\n                        'max': undefined,\n                    },\n                    'price': {\n                        'min': undefined,\n                        'max': undefined,\n                    },\n                    'cost': {\n                        'min': undefined,\n                        'max': undefined,\n                    },\n                },\n            });\n        }\n        return result;\n    }\n\n    async fetchTicker (symbol, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market': market['id'],\n        };\n        // [\n        //   {\n        //     market: 'DIL-ETH',\n        //     time: 1598367493008,\n        //     open: '0.09695361',\n        //     high: '0.10245881',\n        //     low: '0.09572507',\n        //     close: '0.09917079',\n        //     closeQuantity: '0.71320950',\n        //     baseVolume: '309.17380612',\n        //     quoteVolume: '30.57633981',\n        //     percentChange: '2.28',\n        //     numTrades: 205,\n        //     ask: '0.09910476',\n        //     bid: '0.09688340',\n        //     sequence: 3902\n        //   }\n        // ]\n        const response = await this.publicGetTickers (this.extend (request, params));\n        const ticker = this.safeValue (response, 0);\n        return this.parseTicker (ticker, market);\n    }\n\n    async fetchTickers (symbols = undefined, params = {}) {\n        await this.loadMarkets ();\n        // [\n        //   {\n        //     market: 'DIL-ETH',\n        //     time: 1598367493008,\n        //     open: '0.09695361',\n        //     high: '0.10245881',\n        //     low: '0.09572507',\n        //     close: '0.09917079',\n        //     closeQuantity: '0.71320950',\n        //     baseVolume: '309.17380612',\n        //     quoteVolume: '30.57633981',\n        //     percentChange: '2.28',\n        //     numTrades: 205,\n        //     ask: '0.09910476',\n        //     bid: '0.09688340',\n        //     sequence: 3902\n        //   }, ...\n        // ]\n        const response = await this.publicGetTickers (params);\n        return this.parseTickers (response, symbols);\n    }\n\n    parseTickers (rawTickers, symbols = undefined) {\n        const tickers = [];\n        for (let i = 0; i < rawTickers.length; i++) {\n            tickers.push (this.parseTicker (rawTickers[i]));\n        }\n        return this.filterByArray (tickers, 'symbol', symbols);\n    }\n\n    parseTicker (ticker, market = undefined) {\n        // {\n        //   market: 'DIL-ETH',\n        //   time: 1598367493008,\n        //   open: '0.09695361',\n        //   high: '0.10245881',\n        //   low: '0.09572507',\n        //   close: '0.09917079',\n        //   closeQuantity: '0.71320950',\n        //   baseVolume: '309.17380612',\n        //   quoteVolume: '30.57633981',\n        //   percentChange: '2.28',\n        //   numTrades: 205,\n        //   ask: '0.09910476',\n        //   bid: '0.09688340',\n        //   sequence: 3902\n        // }\n        const marketId = this.safeString (ticker, 'market');\n        const symbol = this.safeSymbol (marketId, market, '-');\n        const baseVolume = this.safeFloat (ticker, 'baseVolume');\n        const quoteVolume = this.safeFloat (ticker, 'quoteVolume');\n        const timestamp = this.safeInteger (ticker, 'time');\n        const open = this.safeFloat (ticker, 'open');\n        const high = this.safeFloat (ticker, 'high');\n        const low = this.safeFloat (ticker, 'low');\n        const close = this.safeFloat (ticker, 'close');\n        const ask = this.safeFloat (ticker, 'ask');\n        const bid = this.safeFloat (ticker, 'bid');\n        let percentage = this.safeFloat (ticker, 'percentChange');\n        if (percentage !== undefined) {\n            percentage = 1 + percentage / 100;\n        }\n        let change = undefined;\n        if ((close !== undefined) && (open !== undefined)) {\n            change = close - open;\n        }\n        return {\n            'symbol': symbol,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'high': high,\n            'low': low,\n            'bid': bid,\n            'bidVolume': undefined,\n            'ask': ask,\n            'askVolume': undefined,\n            'vwap': undefined,\n            'open': open,\n            'close': close,\n            'last': close,\n            'previousClose': undefined,\n            'change': change,\n            'percentage': percentage,\n            'average': undefined,\n            'baseVolume': baseVolume,\n            'quoteVolume': quoteVolume,\n            'info': ticker,\n        };\n    }\n\n    async fetchOHLCV (symbol, timeframe = '1m', since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market': market['id'],\n            'interval': timeframe,\n        };\n        if (since !== undefined) {\n            request['start'] = since;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        const response = await this.publicGetCandles (this.extend (request, params));\n        if (Array.isArray (response)) {\n            // [\n            //   {\n            //     start: 1598345580000,\n            //     open: '0.09771286',\n            //     high: '0.09771286',\n            //     low: '0.09771286',\n            //     close: '0.09771286',\n            //     volume: '1.45340410',\n            //     sequence: 3853\n            //   }, ...\n            // ]\n            return this.parseOHLCVs (response, market, timeframe, since, limit);\n        } else {\n            //  {\"nextTime\":1595536440000}\n            return [];\n        }\n    }\n\n    parseOHLCV (ohlcv, market = undefined) {\n        // {\n        //   start: 1598345580000,\n        //   open: '0.09771286',\n        //   high: '0.09771286',\n        //   low: '0.09771286',\n        //   close: '0.09771286',\n        //   volume: '1.45340410',\n        //   sequence: 3853\n        // }\n        const timestamp = this.safeInteger (ohlcv, 'start');\n        const open = this.safeFloat (ohlcv, 'open');\n        const high = this.safeFloat (ohlcv, 'high');\n        const low = this.safeFloat (ohlcv, 'low');\n        const close = this.safeFloat (ohlcv, 'close');\n        const volume = this.safeFloat (ohlcv, 'volume');\n        return [ timestamp, open, high, low, close, volume ];\n    }\n\n    async fetchTrades (symbol, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market': market['id'],\n        };\n        if (since !== undefined) {\n            request['start'] = since;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        // [\n        //   {\n        //     fillId: 'b5467d00-b13e-3fa9-8216-dd66735550fc',\n        //     price: '0.09771286',\n        //     quantity: '1.45340410',\n        //     quoteQuantity: '0.14201627',\n        //     time: 1598345638994,\n        //     makerSide: 'buy',\n        //     sequence: 3853\n        //   }, ...\n        // ]\n        const response = await this.publicGetTrades (this.extend (request, params));\n        return this.parseTrades (response, market, since, limit);\n    }\n\n    parseTrade (trade, market = undefined) {\n        // public trades\n        // {\n        //   fillId: 'b5467d00-b13e-3fa9-8216-dd66735550fc',\n        //   price: '0.09771286',\n        //   quantity: '1.45340410',\n        //   quoteQuantity: '0.14201627',\n        //   time: 1598345638994,\n        //   makerSide: 'buy',\n        //   sequence: 3853\n        // }\n        // private trades\n        // {\n        //   fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n        //   price: '0.09905990',\n        //   quantity: '0.40000000',\n        //   quoteQuantity: '0.03962396',\n        //   time: 1598873478762,\n        //   makerSide: 'sell',\n        //   sequence: 5053,\n        //   market: 'DIL-ETH',\n        //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n        //   side: 'buy',\n        //   fee: '0.00080000',\n        //   feeAsset: 'DIL',\n        //   gas: '0.00857497',\n        //   liquidity: 'taker',\n        //   txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n        //   txStatus: 'mined'\n        // }\n        const id = this.safeString (trade, 'fillId');\n        const price = this.safeFloat (trade, 'price');\n        const amount = this.safeFloat (trade, 'quantity');\n        const cost = this.safeFloat (trade, 'quoteQuantity');\n        const timestamp = this.safeInteger (trade, 'time');\n        const marketId = this.safeString (trade, 'market');\n        const symbol = this.safeSymbol (marketId, market, '-');\n        // this code handles the duality of public vs private trades\n        const makerSide = this.safeString (trade, 'makerSide');\n        const oppositeSide = (makerSide === 'buy') ? 'sell' : 'buy';\n        const side = this.safeString (trade, 'side', oppositeSide);\n        const takerOrMaker = this.safeString (trade, 'liquidity', 'taker');\n        const feeCost = this.safeFloat (trade, 'fee');\n        let fee = undefined;\n        if (feeCost !== undefined) {\n            const feeCurrencyId = this.safeString (trade, 'feeAsset');\n            fee = {\n                'cost': feeCost,\n                'currency': this.safeCurrencyCode (feeCurrencyId),\n            };\n        }\n        const orderId = this.safeString (trade, 'orderId');\n        return {\n            'info': trade,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'symbol': symbol,\n            'id': id,\n            'order': orderId,\n            'type': 'limit',\n            'side': side,\n            'takerOrMaker': takerOrMaker,\n            'price': price,\n            'amount': amount,\n            'cost': cost,\n            'fee': fee,\n        };\n    }\n\n    async fetchOrderBook (symbol, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const request = {\n            'market': market['id'],\n            'level': 2,\n        };\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        // {\n        //   sequence: 36416753,\n        //   bids: [\n        //     [ '0.09672815', '8.22284267', 1 ],\n        //     [ '0.09672814', '1.83685554', 1 ],\n        //     [ '0.09672143', '4.10962617', 1 ],\n        //     [ '0.09658884', '4.03863759', 1 ],\n        //     [ '0.09653781', '3.35730684', 1 ],\n        //     [ '0.09624660', '2.54163586', 1 ],\n        //     [ '0.09617490', '1.93065030', 1 ]\n        //   ],\n        //   asks: [\n        //     [ '0.09910476', '3.22840154', 1 ],\n        //     [ '0.09940587', '3.39796593', 1 ],\n        //     [ '0.09948189', '4.25088898', 1 ],\n        //     [ '0.09958362', '2.42195784', 1 ],\n        //     [ '0.09974393', '4.25234367', 1 ],\n        //     [ '0.09995250', '3.40192141', 1 ]\n        //   ]\n        // }\n        const response = await this.publicGetOrderbook (this.extend (request, params));\n        const nonce = this.safeInteger (response, 'sequence');\n        return {\n            'timestamp': undefined,\n            'datetime': undefined,\n            'nonce': nonce,\n            'bids': this.parseSide (response, 'bids'),\n            'asks': this.parseSide (response, 'asks'),\n        };\n    }\n\n    parseSide (book, side) {\n        const bookSide = this.safeValue (book, side, []);\n        const result = [];\n        for (let i = 0; i < bookSide.length; i++) {\n            const order = bookSide[i];\n            const price = this.safeFloat (order, 0);\n            const amount = this.safeFloat (order, 1);\n            const orderCount = this.safeInteger (order, 2);\n            result.push ([ price, amount, orderCount ]);\n        }\n        const descending = side === 'bids';\n        return this.sortBy (result, 0, descending);\n    }\n\n    async fetchCurrencies (params = {}) {\n        // [\n        //   {\n        //     name: 'Ether',\n        //     symbol: 'ETH',\n        //     contractAddress: '0x0000000000000000000000000000000000000000',\n        //     assetDecimals: 18,\n        //     exchangeDecimals: 8\n        //   }, ..\n        // ]\n        const response = await this.publicGetAssets (params);\n        const result = {};\n        for (let i = 0; i < response.length; i++) {\n            const entry = response[i];\n            const name = this.safeString (entry, 'name');\n            const currencyId = this.safeString (entry, 'symbol');\n            const precision = this.safeInteger (entry, 'exchangeDecimals');\n            const code = this.safeCurrencyCode (currencyId);\n            const lot = Math.pow (-10, precision);\n            result[code] = {\n                'id': currencyId,\n                'code': code,\n                'info': entry,\n                'type': undefined,\n                'name': name,\n                'active': undefined,\n                'fee': undefined,\n                'precision': precision,\n                'limits': {\n                    'amount': { 'min': lot, 'max': undefined },\n                    'price': { 'min': lot, 'max': undefined },\n                    'cost': { 'min': undefined, 'max': undefined },\n                    'withdraw': { 'min': lot, 'max': undefined },\n                },\n            };\n        }\n        return result;\n    }\n\n    async fetchBalance (params = {}) {\n        this.checkRequiredCredentials ();\n        await this.loadMarkets ();\n        const nonce1 = this.uuidv1 ();\n        const request = {\n            'nonce': nonce1,\n            'wallet': this.walletAddress,\n        };\n        // [\n        //   {\n        //     asset: 'DIL',\n        //     quantity: '0.00000000',\n        //     availableForTrade: '0.00000000',\n        //     locked: '0.00000000',\n        //     usdValue: null\n        //   }, ...\n        // ]\n        const extendedRequest = this.extend (request, params);\n        if (extendedRequest['wallet'] === undefined) {\n            throw new BadRequest (this.id + ' wallet is undefined, set this.walletAddress or \"address\" in params');\n        }\n        let response = undefined;\n        try {\n            response = await this.privateGetBalances (extendedRequest);\n        } catch (e) {\n            if (e instanceof InvalidAddress) {\n                const walletAddress = extendedRequest['wallet'];\n                await this.associateWallet (walletAddress);\n                response = await this.privateGetBalances (extendedRequest);\n            } else {\n                throw e;\n            }\n        }\n        const result = {\n            'info': response,\n        };\n        for (let i = 0; i < response.length; i++) {\n            const entry = response[i];\n            const currencyId = this.safeString (entry, 'asset');\n            const code = this.safeCurrencyCode (currencyId);\n            const total = this.safeFloat (entry, 'quantity');\n            const free = this.safeFloat (entry, 'availableForTrade');\n            const used = this.safeFloat (entry, 'locked');\n            result[code] = {\n                'free': free,\n                'used': used,\n                'total': total,\n            };\n        }\n        return this.parseBalance (result);\n    }\n\n    async fetchMyTrades (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        this.checkRequiredCredentials ();\n        await this.loadMarkets ();\n        let market = undefined;\n        const request = {\n            'nonce': this.uuidv1 (),\n            'wallet': this.walletAddress,\n        };\n        if (symbol !== undefined) {\n            market = this.market (symbol);\n            request['market'] = market['id'];\n        }\n        if (since !== undefined) {\n            request['start'] = since;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        // [\n        //   {\n        //     fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n        //     price: '0.09905990',\n        //     quantity: '0.40000000',\n        //     quoteQuantity: '0.03962396',\n        //     time: 1598873478762,\n        //     makerSide: 'sell',\n        //     sequence: 5053,\n        //     market: 'DIL-ETH',\n        //     orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n        //     side: 'buy',\n        //     fee: '0.00080000',\n        //     feeAsset: 'DIL',\n        //     gas: '0.00857497',\n        //     liquidity: 'taker',\n        //     txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n        //     txStatus: 'mined'\n        //   }\n        // ]\n        const extendedRequest = this.extend (request, params);\n        if (extendedRequest['wallet'] === undefined) {\n            throw new BadRequest (this.id + ' walletAddress is undefined, set this.walletAddress or \"address\" in params');\n        }\n        let response = undefined;\n        try {\n            response = await this.privateGetFills (extendedRequest);\n        } catch (e) {\n            if (e instanceof InvalidAddress) {\n                const walletAddress = extendedRequest['wallet'];\n                await this.associateWallet (walletAddress);\n                response = await this.privateGetFills (extendedRequest);\n            } else {\n                throw e;\n            }\n        }\n        return this.parseTrades (response, market, since, limit);\n    }\n\n    async fetchOrder (id, symbol = undefined, params = {}) {\n        const request = {\n            'orderId': id,\n        };\n        return await this.fetchOrdersHelper (symbol, undefined, undefined, this.extend (request, params));\n    }\n\n    async fetchOpenOrders (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        const request = {\n            'closed': false,\n        };\n        return await this.fetchOrdersHelper (symbol, since, limit, this.extend (request, params));\n    }\n\n    async fetchClosedOrders (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        const request = {\n            'closed': true,\n        };\n        return await this.fetchOrdersHelper (symbol, since, limit, this.extend (request, params));\n    }\n\n    async fetchOrdersHelper (symbol = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const request = {\n            'nonce': this.uuidv1 (),\n            'wallet': this.walletAddress,\n        };\n        let market = undefined;\n        if (symbol !== undefined) {\n            market = this.market (symbol);\n            request['market'] = market['id'];\n        }\n        if (since !== undefined) {\n            request['start'] = since;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        const response = await this.privateGetOrders (this.extend (request, params));\n        // fetchClosedOrders / fetchOpenOrders\n        // [\n        //   {\n        //     \"market\": \"DIL-ETH\",\n        //     \"orderId\": \"7cdc8e90-eb7d-11ea-9e60-4118569f6e63\",\n        //     \"wallet\": \"0x0AB991497116f7F5532a4c2f4f7B1784488628e1\",\n        //     \"time\": 1598873478650,\n        //     \"status\": \"filled\",\n        //     \"type\": \"limit\",\n        //     \"side\": \"buy\",\n        //     \"originalQuantity\": \"0.40000000\",\n        //     \"executedQuantity\": \"0.40000000\",\n        //     \"cumulativeQuoteQuantity\": \"0.03962396\",\n        //     \"avgExecutionPrice\": \"0.09905990\",\n        //     \"price\": \"1.00000000\",\n        //     \"fills\": [\n        //       {\n        //         \"fillId\": \"48582d10-b9bb-3c4b-94d3-e67537cf2472\",\n        //         \"price\": \"0.09905990\",\n        //         \"quantity\": \"0.40000000\",\n        //         \"quoteQuantity\": \"0.03962396\",\n        //         \"time\": 1598873478650,\n        //         \"makerSide\": \"sell\",\n        //         \"sequence\": 5053,\n        //         \"fee\": \"0.00080000\",\n        //         \"feeAsset\": \"DIL\",\n        //         \"gas\": \"0.00857497\",\n        //         \"liquidity\": \"taker\",\n        //         \"txId\": \"0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65\",\n        //         \"txStatus\": \"mined\"\n        //       }\n        //     ]\n        //   }\n        // ]\n        // fetchOrder\n        // { market: 'DIL-ETH',\n        //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n        //   wallet: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n        //   time: 1598873478650,\n        //   status: 'filled',\n        //   type: 'limit',\n        //   side: 'buy',\n        //   originalQuantity: '0.40000000',\n        //   executedQuantity: '0.40000000',\n        //   cumulativeQuoteQuantity: '0.03962396',\n        //   avgExecutionPrice: '0.09905990',\n        //   price: '1.00000000',\n        //   fills:\n        //    [ { fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n        //        price: '0.09905990',\n        //        quantity: '0.40000000',\n        //        quoteQuantity: '0.03962396',\n        //        time: 1598873478650,\n        //        makerSide: 'sell',\n        //        sequence: 5053,\n        //        fee: '0.00080000',\n        //        feeAsset: 'DIL',\n        //        gas: '0.00857497',\n        //        liquidity: 'taker',\n        //        txId: '0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65',\n        //        txStatus: 'mined' } ] }\n        if (Array.isArray (response)) {\n            return this.parseOrders (response, market, since, limit);\n        } else {\n            return this.parseOrder (response, market);\n        }\n    }\n\n    parseOrderStatus (status) {\n        // https://docs.idex.io/#order-states-amp-lifecycle\n        const statuses = {\n            'active': 'open',\n            'partiallyFilled': 'open',\n            'rejected': 'canceled',\n            'filled': 'closed',\n        };\n        return this.safeString (statuses, status, status);\n    }\n\n    parseOrder (order, market = undefined) {\n        //\n        //     {\n        //         \"market\": \"DIL-ETH\",\n        //         \"orderId\": \"7cdc8e90-eb7d-11ea-9e60-4118569f6e63\",\n        //         \"wallet\": \"0x0AB991497116f7F5532a4c2f4f7B1784488628e1\",\n        //         \"time\": 1598873478650,\n        //         \"status\": \"filled\",\n        //         \"type\": \"limit\",\n        //         \"side\": \"buy\",\n        //         \"originalQuantity\": \"0.40000000\",\n        //         \"executedQuantity\": \"0.40000000\",\n        //         \"cumulativeQuoteQuantity\": \"0.03962396\",\n        //         \"avgExecutionPrice\": \"0.09905990\",\n        //         \"price\": \"1.00000000\",\n        //         \"fills\": [\n        //             {\n        //             \"fillId\": \"48582d10-b9bb-3c4b-94d3-e67537cf2472\",\n        //             \"price\": \"0.09905990\",\n        //             \"quantity\": \"0.40000000\",\n        //             \"quoteQuantity\": \"0.03962396\",\n        //             \"time\": 1598873478650,\n        //             \"makerSide\": \"sell\",\n        //             \"sequence\": 5053,\n        //             \"fee\": \"0.00080000\",\n        //             \"feeAsset\": \"DIL\",\n        //             \"gas\": \"0.00857497\",\n        //             \"liquidity\": \"taker\",\n        //             \"txId\": \"0xeaa02b112c0b8b61bc02fa1776a2b39d6c614e287c1af90df0a2e591da573e65\",\n        //             \"txStatus\": \"mined\"\n        //             }\n        //         ]\n        //     }\n        //\n        const timestamp = this.safeInteger (order, 'time');\n        const fills = this.safeValue (order, 'fills', []);\n        const id = this.safeString (order, 'orderId');\n        const clientOrderId = this.safeString (order, 'clientOrderId');\n        const marketId = this.safeString (order, 'market');\n        const side = this.safeString (order, 'side');\n        const symbol = this.safeSymbol (marketId, market, '-');\n        const trades = this.parseTrades (fills, market);\n        const type = this.safeString (order, 'type');\n        const amount = this.safeFloat (order, 'originalQuantity');\n        const filled = this.safeFloat (order, 'executedQuantity');\n        let remaining = undefined;\n        if ((amount !== undefined) && (filled !== undefined)) {\n            remaining = amount - filled;\n        }\n        const average = this.safeFloat (order, 'avgExecutionPrice');\n        const price = this.safeFloat (order, 'price', average);  // for market orders\n        let cost = undefined;\n        if ((amount !== undefined) && (price !== undefined)) {\n            cost = amount * price;\n        }\n        const rawStatus = this.safeString (order, 'status');\n        const status = this.parseOrderStatus (rawStatus);\n        const fee = {\n            'currency': undefined,\n            'cost': undefined,\n        };\n        let lastTrade = undefined;\n        for (let i = 0; i < trades.length; i++) {\n            lastTrade = trades[i];\n            fee['currency'] = lastTrade['fee']['currency'];\n            fee['cost'] = this.sum (fee['cost'], lastTrade['fee']['cost']);\n        }\n        const lastTradeTimestamp = this.safeInteger (lastTrade, 'timestamp');\n        return {\n            'info': order,\n            'id': id,\n            'clientOrderId': clientOrderId,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'lastTradeTimestamp': lastTradeTimestamp,\n            'symbol': symbol,\n            'type': type,\n            'timeInForce': undefined,\n            'postOnly': undefined,\n            'side': side,\n            'price': price,\n            'stopPrice': undefined,\n            'amount': amount,\n            'cost': cost,\n            'average': average,\n            'filled': filled,\n            'remaining': remaining,\n            'status': status,\n            'fee': fee,\n            'trades': trades,\n        };\n    }\n\n    async associateWallet (walletAddress, params = {}) {\n        const nonce = this.uuidv1 ();\n        const noPrefix = this.remove0xPrefix (walletAddress);\n        const byteArray = [\n            this.base16ToBinary (nonce),\n            this.base16ToBinary (noPrefix),\n        ];\n        const binary = this.binaryConcatArray (byteArray);\n        const hash = this.hash (binary, 'keccak', 'hex');\n        const signature = this.signMessageString (hash, this.privateKey);\n        // {\n        //   address: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n        //   totalPortfolioValueUsd: '0.00',\n        //   time: 1598468353626\n        // }\n        const request = {\n            'parameters': {\n                'nonce': nonce,\n                'wallet': walletAddress,\n            },\n            'signature': signature,\n        };\n        const result = await this.privatePostWallets (request);\n        return result;\n    }\n\n    async createOrder (symbol, type, side, amount, price = undefined, params = {}) {\n        // https://docs.idex.io/#create-order\n        this.checkRequiredCredentials ();\n        await this.loadMarkets ();\n        const market = this.market (symbol);\n        const nonce = this.uuidv1 ();\n        let typeEnum = undefined;\n        const stopLossTypeEnums = {\n            'stopLoss': 3,\n            'stopLossLimit': 4,\n            'takeProfit': 5,\n            'takeProfitLimit': 6,\n        };\n        let stopPriceString = undefined;\n        if ((type === 'stopLossLimit') || (type === 'takeProfitLimit') || ('stopPrice' in params)) {\n            if (!('stopPrice' in params)) {\n                throw new BadRequest (this.id + ' stopPrice is a required parameter for ' + type + 'orders');\n            }\n            stopPriceString = this.priceToPrecision (symbol, params['stopPrice']);\n        }\n        const limitTypeEnums = {\n            'limit': 1,\n            'limitMaker': 2,\n        };\n        let priceString = undefined;\n        const typeLower = type.toLowerCase ();\n        const limitOrder = typeLower.indexOf ('limit') > -1;\n        if (type in limitTypeEnums) {\n            typeEnum = limitTypeEnums[type];\n            priceString = this.priceToPrecision (symbol, price);\n        } else if (type in stopLossTypeEnums) {\n            typeEnum = stopLossTypeEnums[type];\n            priceString = this.priceToPrecision (symbol, price);\n        } else if (type === 'market') {\n            typeEnum = 0;\n        } else {\n            throw new BadRequest (this.id + ' ' + type + ' is not a valid order type');\n        }\n        let amountEnum = 0; // base quantity\n        if ('quoteOrderQuantity' in params) {\n            if (type !== 'market') {\n                throw new NotSupported (this.id + ' quoteOrderQuantity is not supported for ' + type + ' orders, only supported for market orders');\n            }\n            amountEnum = 1;\n            amount = this.safeFloat (params, 'quoteOrderQuantity');\n        }\n        const sideEnum = (side === 'buy') ? 0 : 1;\n        const walletBytes = this.remove0xPrefix (this.walletAddress);\n        const orderVersion = 1;\n        const amountString = this.amountToPrecision (symbol, amount);\n        // https://docs.idex.io/#time-in-force\n        const timeInForceEnums = {\n            'gtc': 0,\n            'ioc': 2,\n            'fok': 3,\n        };\n        const defaultTimeInForce = this.safeString (this.options, 'defaultTimeInForce', 'gtc');\n        const timeInForce = this.safeString (params, 'timeInForce', defaultTimeInForce);\n        let timeInForceEnum = undefined;\n        if (timeInForce in timeInForceEnums) {\n            timeInForceEnum = timeInForceEnums[timeInForce];\n        } else {\n            const allOptions = Object.keys (timeInForceEnums);\n            const asString = allOptions.join (', ');\n            throw new BadRequest (this.id + ' ' + timeInForce + ' is not a valid timeInForce, please choose one of ' + asString);\n        }\n        // https://docs.idex.io/#self-trade-prevention\n        const selfTradePreventionEnums = {\n            'dc': 0,\n            'co': 1,\n            'cn': 2,\n            'cb': 3,\n        };\n        const defaultSelfTradePrevention = this.safeString (this.options, 'defaultSelfTradePrevention', 'cn');\n        const selfTradePrevention = this.safeString (params, 'selfTradePrevention', defaultSelfTradePrevention);\n        let selfTradePreventionEnum = undefined;\n        if (selfTradePrevention in selfTradePreventionEnums) {\n            selfTradePreventionEnum = selfTradePreventionEnums[selfTradePrevention];\n        } else {\n            const allOptions = Object.keys (selfTradePreventionEnums);\n            const asString = allOptions.join (', ');\n            throw new BadRequest (this.id + ' ' + selfTradePrevention + ' is not a valid selfTradePrevention, please choose one of ' + asString);\n        }\n        const byteArray = [\n            this.numberToBE (orderVersion, 1),\n            this.base16ToBinary (nonce),\n            this.base16ToBinary (walletBytes),\n            this.stringToBinary (this.encode (market['id'])),  // TODO: refactor to remove either encode or stringToBinary\n            this.numberToBE (typeEnum, 1),\n            this.numberToBE (sideEnum, 1),\n            this.stringToBinary (this.encode (amountString)),\n            this.numberToBE (amountEnum, 1),\n        ];\n        if (limitOrder) {\n            const encodedPrice = this.stringToBinary (this.encode (priceString));\n            byteArray.push (encodedPrice);\n        }\n        if (type in stopLossTypeEnums) {\n            const encodedPrice = this.stringToBinary (this.encode (stopPriceString || priceString));\n            byteArray.push (encodedPrice);\n        }\n        const clientOrderId = this.safeString (params, 'clientOrderId');\n        if (clientOrderId !== undefined) {\n            byteArray.push (this.stringToBinary (this.encode (clientOrderId)));\n        }\n        const after = [\n            this.numberToBE (timeInForceEnum, 1),\n            this.numberToBE (selfTradePreventionEnum, 1),\n            this.numberToBE (0, 8), // unused\n        ];\n        const allBytes = this.arrayConcat (byteArray, after);\n        const binary = this.binaryConcatArray (allBytes);\n        const hash = this.hash (binary, 'keccak', 'hex');\n        const signature = this.signMessageString (hash, this.privateKey);\n        const request = {\n            'parameters': {\n                'nonce': nonce,\n                'market': market['id'],\n                'side': side,\n                'type': type,\n                'wallet': this.walletAddress,\n                'timeInForce': timeInForce,\n                'selfTradePrevention': selfTradePrevention,\n            },\n            'signature': signature,\n        };\n        if (limitOrder) {\n            request['parameters']['price'] = priceString;\n        }\n        if (type in stopLossTypeEnums) {\n            request['parameters']['stopPrice'] = stopPriceString || priceString;\n        }\n        if (amountEnum === 0) {\n            request['parameters']['quantity'] = amountString;\n        } else {\n            request['parameters']['quoteOrderQuantity'] = amountString;\n        }\n        if (clientOrderId !== undefined) {\n            request['parameters']['clientOrderId'] = clientOrderId;\n        }\n        // {\n        //   market: 'DIL-ETH',\n        //   orderId: '7cdc8e90-eb7d-11ea-9e60-4118569f6e63',\n        //   wallet: '0x0AB991497116f7F5532a4c2f4f7B1784488628e1',\n        //   time: 1598873478650,\n        //   status: 'filled',\n        //   type: 'limit',\n        //   side: 'buy',\n        //   originalQuantity: '0.40000000',\n        //   executedQuantity: '0.40000000',\n        //   cumulativeQuoteQuantity: '0.03962396',\n        //   price: '1.00000000',\n        //   fills: [\n        //     {\n        //       fillId: '48582d10-b9bb-3c4b-94d3-e67537cf2472',\n        //       price: '0.09905990',\n        //       quantity: '0.40000000',\n        //       quoteQuantity: '0.03962396',\n        //       time: 1598873478650,\n        //       makerSide: 'sell',\n        //       sequence: 5053,\n        //       fee: '0.00080000',\n        //       feeAsset: 'DIL',\n        //       gas: '0.00857497',\n        //       liquidity: 'taker',\n        //       txStatus: 'pending'\n        //     }\n        //   ],\n        //   avgExecutionPrice: '0.09905990'\n        // }\n        // we don't use extend here because it is a signed endpoint\n        const response = await this.privatePostOrders (request);\n        return this.parseOrder (response, market);\n    }\n\n    async withdraw (code, amount, address, tag = undefined, params = {}) {\n        this.checkRequiredCredentials ();\n        await this.loadMarkets ();\n        const nonce = this.uuidv1 ();\n        const amountString = this.currencyToPrecision (code, amount);\n        const currency = this.currency (code);\n        const walletBytes = this.remove0xPrefix (this.walletAddress);\n        const byteArray = [\n            this.base16ToBinary (nonce),\n            this.base16ToBinary (walletBytes),\n            this.stringToBinary (this.encode (currency['id'])),\n            this.stringToBinary (this.encode (amountString)),\n            this.numberToBE (1, 1), // bool set to true\n        ];\n        const binary = this.binaryConcatArray (byteArray);\n        const hash = this.hash (binary, 'keccak', 'hex');\n        const signature = this.signMessageString (hash, this.privateKey);\n        const request = {\n            'parameters': {\n                'nonce': nonce,\n                'wallet': address,\n                'asset': currency['id'],\n                'quantity': amountString,\n            },\n            'signature': signature,\n        };\n        // {\n        //   withdrawalId: 'a61dcff0-ec4d-11ea-8b83-c78a6ecb3180',\n        //   asset: 'ETH',\n        //   assetContractAddress: '0x0000000000000000000000000000000000000000',\n        //   quantity: '0.20000000',\n        //   time: 1598962883190,\n        //   fee: '0.00024000',\n        //   txStatus: 'pending',\n        //   txId: null\n        // }\n        const response = await this.privatePostWithdrawals (request);\n        const id = this.safeString (response, 'withdrawalId');\n        return {\n            'info': response,\n            'id': id,\n        };\n    }\n\n    async cancelOrder (id, symbol = undefined, params = {}) {\n        this.checkRequiredCredentials ();\n        await this.loadMarkets ();\n        let market = undefined;\n        if (symbol !== undefined) {\n            market = this.market (symbol);\n        }\n        const nonce = this.uuidv1 ();\n        const walletBytes = this.remove0xPrefix (this.walletAddress);\n        const byteArray = [\n            this.base16ToBinary (nonce),\n            this.base16ToBinary (walletBytes),\n            this.stringToBinary (this.encode (id)),\n        ];\n        const binary = this.binaryConcatArray (byteArray);\n        const hash = this.hash (binary, 'keccak', 'hex');\n        const signature = this.signMessageString (hash, this.privateKey);\n        const request = {\n            'parameters': {\n                'nonce': nonce,\n                'wallet': this.walletAddress,\n                'orderId': id,\n            },\n            'signature': signature,\n        };\n        // [ { orderId: '688336f0-ec50-11ea-9842-b332f8a34d0e' } ]\n        const response = await this.privateDeleteOrders (this.extend (request, params));\n        const canceledOrder = this.safeValue (response, 0);\n        return this.parseOrder (canceledOrder, market);\n    }\n\n    handleErrors (code, reason, url, method, headers, body, response, requestHeaders, requestBody) {\n        const errorCode = this.safeString (response, 'code');\n        const message = this.safeString (response, 'message');\n        if (errorCode in this.exceptions) {\n            const Exception = this.exceptions[errorCode];\n            throw new Exception (this.id + ' ' + message);\n        }\n        if (errorCode !== undefined) {\n            throw new ExchangeError (this.id + ' ' + message);\n        }\n    }\n\n    async fetchDeposits (code = undefined, since = undefined, limit = undefined, params = {}) {\n        params = this.extend ({\n            'method': 'privateGetDeposits',\n        }, params);\n        return this.fetchTransactionsHelper (code, since, limit, params);\n    }\n\n    async fetchWithdrawals (code = undefined, since = undefined, limit = undefined, params = {}) {\n        params = this.extend ({\n            'method': 'privateGetWithdrawals',\n        }, params);\n        return this.fetchTransactionsHelper (code, since, limit, params);\n    }\n\n    async fetchTransactionsHelper (code = undefined, since = undefined, limit = undefined, params = {}) {\n        await this.loadMarkets ();\n        const nonce = this.uuidv1 ();\n        const request = {\n            'nonce': nonce,\n            'wallet': this.walletAddress,\n        };\n        let currency = undefined;\n        if (code !== undefined) {\n            currency = this.currency (code);\n            request['asset'] = currency['id'];\n        }\n        if (since !== undefined) {\n            request['start'] = since;\n        }\n        if (limit !== undefined) {\n            request['limit'] = limit;\n        }\n        // [\n        //   {\n        //     depositId: 'e9970cc0-eb6b-11ea-9e89-09a5ebc1f98e',\n        //     asset: 'ETH',\n        //     quantity: '1.00000000',\n        //     txId: '0xcd4aac3171d7131cc9e795568c67938675185ac17641553ef54c8a7c294c8142',\n        //     txTime: 1598865853000,\n        //     confirmationTime: 1598865930231\n        //   }\n        // ]\n        const method = params['method'];\n        params = this.omit (params, 'method');\n        const response = await this[method] (this.extend (request, params));\n        return this.parseTransactions (response, currency, since, limit);\n    }\n\n    parseTransactionStatus (status) {\n        const statuses = {\n            'mined': 'ok',\n        };\n        return this.safeString (statuses, status, status);\n    }\n\n    parseTransaction (transaction, currency = undefined) {\n        // fetchDeposits\n        // {\n        //   depositId: 'e9970cc0-eb6b-11ea-9e89-09a5ebc1f98f',\n        //   asset: 'ETH',\n        //   quantity: '1.00000000',\n        //   txId: '0xcd4aac3171d7131cc9e795568c67938675185ac17641553ef54c8a7c294c8142',\n        //   txTime: 1598865853000,\n        //   confirmationTime: 1598865930231\n        // }\n        // fetchWithdrwalas\n        // {\n        //   withdrawalId: 'a62d8760-ec4d-11ea-9fa6-47904c19499b',\n        //   asset: 'ETH',\n        //   assetContractAddress: '0x0000000000000000000000000000000000000000',\n        //   quantity: '0.20000000',\n        //   time: 1598962883288,\n        //   fee: '0.00024000',\n        //   txId: '0x305e9cdbaa85ad029f50578d13d31d777c085de573ed5334d95c19116d8c03ce',\n        //   txStatus: 'mined'\n        //  }\n        let type = undefined;\n        if ('depositId' in transaction) {\n            type = 'deposit';\n        } else if ('withdrawalId' in transaction) {\n            type = 'withdrawal';\n        }\n        const id = this.safeString2 (transaction, 'depositId', 'withdrawId');\n        const code = this.safeCurrencyCode (this.safeString (transaction, 'asset'), currency);\n        const amount = this.safeFloat (transaction, 'quantity');\n        const txid = this.safeString (transaction, 'txId');\n        const timestamp = this.safeInteger (transaction, 'txTime');\n        let fee = undefined;\n        if ('fee' in transaction) {\n            fee = {\n                'cost': this.safeFloat (transaction, 'fee'),\n                'currency': 'ETH',\n            };\n        }\n        const rawStatus = this.safeString (transaction, 'txStatus');\n        const status = this.parseTransactionStatus (rawStatus);\n        const updated = this.safeInteger (transaction, 'confirmationTime');\n        return {\n            'info': transaction,\n            'id': id,\n            'txid': txid,\n            'timestamp': timestamp,\n            'datetime': this.iso8601 (timestamp),\n            'address': undefined,\n            'tag': undefined,\n            'type': type,\n            'amount': amount,\n            'currency': code,\n            'status': status,\n            'updated': updated,\n            'fee': fee,\n        };\n    }\n\n    sign (path, api = 'public', method = 'GET', params = {}, headers = undefined, body = undefined) {\n        const version = this.safeString (this.options, 'version', 'v1');\n        let url = this.urls['api'][api] + '/' + version + '/' + path;\n        const keys = Object.keys (params);\n        const length = keys.length;\n        let query = undefined;\n        if (length > 0) {\n            if (method === 'GET') {\n                query = this.urlencode (params);\n                url = url + '?' + query;\n            } else {\n                body = this.json (params);\n            }\n        }\n        headers = {\n            'Content-Type': 'application/json',\n        };\n        if (this.apiKey !== undefined) {\n            headers['IDEX-API-Key'] = this.apiKey;\n        }\n        if (api === 'private') {\n            let payload = undefined;\n            if (method === 'GET') {\n                payload = query;\n            } else {\n                payload = body;\n            }\n            headers['IDEX-HMAC-Signature'] = this.hmac (this.encode (payload), this.encode (this.secret), 'sha256', 'hex');\n        }\n        return { 'url': url, 'method': method, 'body': body, 'headers': headers };\n    }\n};\n"]},"metadata":{},"sourceType":"script"}